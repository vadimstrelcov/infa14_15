lecture
файловая система - система файлов
файловая система - часть операционной системы, назначение которой состоит в том, чтобы организовать эффективную работу с данными, хранящимися во внешней памяти и обеспечить пользователю удобный интерфейс при работе с этими данными.

физические носители информации
	магнитные диски
	оптические диски
	твердотельные накопители
	и т.д.
Структура разная, интерфейс одинаковый
	драйвер устройства
	файловая система

Логические диски
Физ. носители принято делить на лог диски
	несколько ОС
	несколько видов ФС
	различные категории файлов
	внутренние требования ОС или ФС
Загрузчик linux - ext2
А для пользовательских файлов - ext3, ext4

лог структура ФС
типы файлов
	регулярные файлы
	директории
	файлы типа FIFO
	файлы устройств
	сокеты (sockets)
	файлы связи (link)

Полное имя файла
/ - корневой узел
/../директории/../filename

ФС s5fs
System V File System - прородитель современной ФС linux'а.
	заголовок раздела: массив индексов узлов и суперблок
	логические блоки
файл:
	тип файла, права доступа
	id владельца и его группы
	размер файла
	время последнего доступа
	время последней модификации файла
	время последней модификации узла

Понятие суперблока
	тип ФС
	флаги состояния ФС
	размер логического блока в байтах
	размер ФС в ЛБ
	размер массива индексных узлов
			свободных блоков
			...

Операции над файлами
	последовательный доступ
		чтение и запись порции (read & write), позиционировании на начале (rewind)
	прямой доступ
		чтение и запись порции, позиционирование на требуемой части данных (seek)
	кроме того
		создание нового объекта (new)
		уничтожение существующего (free)
		прочитай атрибуты (get attribute)
		установить атрибуды (set attribute)

cp, rm, mv, ls, chmod
open(), close(), read(), write()

#include <fcntl.h>
int creat(const char *pathname, mode_t mode);

изменение аттрибутов
man 2 stat
stat
fstat
lstat
struct stat {};

Изменить длину файла
ftruncate

Изменение текущей позиции
lseek()

Создание связей
жесткая связь (hard link)
	проблема удаления, счетчик ЖС
	опасность зацикливания, запрет ЖС на директорию
	ln name name2 - создание
	link()
мягкая (символическая) связь (soft symbolic link)
	symlink()
unlink() - удаление

Hard Link
index nodes
/tmp/file1 to data	/home/student/file1 to data
		|data|
Symbolic Link
/tmp/file1 to data	/home/student/file1 to /tmp/file1
		|data|

ln file.txt file2.txt
./2 file.txt
-> 2 hard link
./2 file2.txt
-> 2 hard link
unlink file2.txt
